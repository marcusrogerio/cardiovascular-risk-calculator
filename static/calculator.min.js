function gender(e){e&&$(e).addClass("active").siblings().removeClass("active");return $("#male").hasClass("active")?1:0}function male(){return 1==gender()}function female(){return 0==gender()}function smoker(e){e&&$(e).addClass("active").siblings().removeClass("active");return $("#smoker_yes").hasClass("active")?1:0}function diabetes(e){e&&$(e).addClass("active").siblings().removeClass("active");return $("#diabetes_yes").hasClass("active")?1:0}function adjust(e,t,n){var r=$(t).val();!_useMMOL&&("chol"==e||"hdl"==e)&&(r=Math.round(r*38.666666));$("#"+e).text(r?Math.round(r*10)/10:0);n||CALC()}function toggleBenefit(e){$(e).toggleClass("active").siblings().removeClass("active");CALC()}function benefit(e){if(!!e&&e in _benefit){var t=$("#benefit_estimates").find("li").map(function(e,t){var n=$(t);if(n.hasClass("active"))return n.data("benefit")}).get(),n=0;for(var r in _benefit[e]){if(!t.contains(r))continue;var i=_benefit[e][r];if("number"!=typeof i){var s=0,o=null;for(var u in i)if("default"==u)s=i[u];else{var a=window[u];if(!a||"function"!=typeof a)alert("The benefit for "+r+" of type "+u+" is invalid, needs to be a function name");else if(a()){o=i[u];break}}i=null!==o?o:s}if("number"!=typeof i){console.error(i);alert("Not a numerical value for benefit "+r+": "+i)}else i>n&&(n=i)}return n}alert("I cannot currently calculate benefits for this formula: "+(e?e:"not defined"));return 0}function setFormula(e){setFormulaById($(e).data("calc"))}function setFormulaById(e){if(!e)return;_formula_id=e;$("#formula_selector").find("li").removeClass("active").filter(function(e){return $(this).data("calc")==_formula_id}).addClass("active");calculate(e)}function CALC(){calculate(_formula_id)}function calculate(e){var t=$("#overestimate").text()*1,n=benefit(e);$("#benefit").text(n);var r=$("#time").text()*1,i=gender(),s=$("#age").text()*1,o=$("#sbp").text()*1,u=smoker(),a=$("#totalchol").val()*1,f=$("#hdlchol").val()*1,l=diabetes(),c=0,h=120,p=0,d=3,v=1.3,m=0,g=0,y=0,b=0;if("cvd"==e){y=t*(1-Math.exp(-Math.exp((Math.log(r)-(18.8144+ -1.2146*(1-i)+ -1.8443*Math.log(s)+0*Math.log(s)*Math.log(s)+.3668*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -1.4032*Math.log(o)+ -0.3899*u+ -0.539*Math.log(a/f)+ -0.3036*l+ -0.1697*l*(1-i)+ -0.3362*c+0*c*i))/(Math.exp(.6536)*Math.exp(-0.2402*(18.8144+ -1.2146*(1-i)+ -1.8443*Math.log(s)+0*Math.log(s)*Math.log(s)+.3668*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -1.4032*Math.log(o)+ -0.3899*u+ -0.539*Math.log(a/f)+ -0.3036*l+ -0.1697*l*(1-i)+ -0.3362*c+0*c*i))))));b=t*(1-Math.exp(-Math.exp((Math.log(r)-(18.8144+ -1.2146*(1-i)+ -1.8443*Math.log(s)+0*Math.log(s)*Math.log(s)+.3668*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -1.4032*Math.log(h)+ -0.3899*p+ -0.539*Math.log(d/v)+ -0.3036*m+ -0.1697*m*(1-i)+ -0.3362*g+0*g*i))/(Math.exp(.6536)*Math.exp(-0.2402*(18.8144+ -1.2146*(1-i)+ -1.8443*Math.log(s)+0*Math.log(s)*Math.log(s)+.3668*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -1.4032*Math.log(h)+ -0.3899*p+ -0.539*Math.log(d/v)+ -0.3036*m+ -0.1697*m*(1-i)+ -0.3362*g+0*g*i))))))}else if("chd"==e){y=t*(1-Math.exp(-Math.exp((Math.log(r)-(15.5305+28.4441*(1-i)+ -1.4792*Math.log(s)+0*Math.log(s)*Math.log(s)+ -14.4588*Math.log(s)*(1-i)+1.8515*Math.log(s)*Math.log(s)*(1-i)+ -0.9119*Math.log(o)+ -0.2767*u+ -0.7181*Math.log(a/f)+ -0.1759*l+ -0.1999*l*(1-i)+ -0.5865*c+0*c*i))/(Math.exp(.9145)*Math.exp(-0.2784*(15.5305+28.4441*(1-i)+ -1.4792*Math.log(s)+0*Math.log(s)*Math.log(s)+ -14.4588*Math.log(s)*(1-i)+1.8515*Math.log(s)*Math.log(s)*(1-i)+ -0.9119*Math.log(o)+ -0.2767*u+ -0.7181*Math.log(a/f)+ -0.1759*l+ -0.1999*l*(1-i)+ -0.5865*c+0*c*i))))));b=t*(1-Math.exp(-Math.exp((Math.log(r)-(15.5305+28.4441*(1-i)+ -1.4792*Math.log(s)+0*Math.log(s)*Math.log(s)+ -14.4588*Math.log(s)*(1-i)+1.8515*Math.log(s)*Math.log(s)*(1-i)+ -0.9119*Math.log(h)+ -0.2767*p+ -0.7181*Math.log(d/v)+ -0.1759*m+ -0.1999*m*(1-i)+ -0.5865*g+0*g*i))/(Math.exp(.9145)*Math.exp(-0.2784*(15.5305+28.4441*(1-i)+ -1.4792*Math.log(s)+0*Math.log(s)*Math.log(s)+ -14.4588*Math.log(s)*(1-i)+1.8515*Math.log(s)*Math.log(s)*(1-i)+ -0.9119*Math.log(h)+ -0.2767*p+ -0.7181*Math.log(d/v)+ -0.1759*m+ -0.1999*m*(1-i)+ -0.5865*g+0*g*i))))))}else if("mi"==e){y=t*(1-Math.exp(-Math.exp((Math.log(r)-(11.4712+10.5109*(1-i)+ -0.7965*Math.log(s)+0*Math.log(s)*Math.log(s)+ -5.4216*Math.log(s)*(1-i)+.7101*Math.log(s)*Math.log(s)*(1-i)+ -0.6623*Math.log(o)+ -0.2675*u+ -0.4277*Math.log(a/f)+ -0.1534*l+ -0.1165*l*(1-i)+0*c+ -0.1588*c*i))/(Math.exp(3.4064)*Math.exp(-0.8584*(11.4712+10.5109*(1-i)+ -0.7965*Math.log(s)+0*Math.log(s)*Math.log(s)+ -5.4216*Math.log(s)*(1-i)+.7101*Math.log(s)*Math.log(s)*(1-i)+ -0.6623*Math.log(o)+ -0.2675*u+ -0.4277*Math.log(a/f)+ -0.1534*l+ -0.1165*l*(1-i)+0*c+ -0.1588*c*i))))));b=t*(1-Math.exp(-Math.exp((Math.log(r)-(11.4712+10.5109*(1-i)+ -0.7965*Math.log(s)+0*Math.log(s)*Math.log(s)+ -5.4216*Math.log(s)*(1-i)+.7101*Math.log(s)*Math.log(s)*(1-i)+ -0.6623*Math.log(h)+ -0.2675*p+ -0.4277*Math.log(d/v)+ -0.1534*m+ -0.1165*m*(1-i)+0*g+ -0.1588*g*i))/(Math.exp(3.4064)*Math.exp(-0.8584*(11.4712+10.5109*(1-i)+ -0.7965*Math.log(s)+0*Math.log(s)*Math.log(s)+ -5.4216*Math.log(s)*(1-i)+.7101*Math.log(s)*Math.log(s)*(1-i)+ -0.6623*Math.log(h)+ -0.2675*p+ -0.4277*Math.log(d/v)+ -0.1534*m+ -0.1165*m*(1-i)+0*g+ -0.1588*g*i))))))}else if("stroke"==e){y=t*(1-Math.exp(-Math.exp((Math.log(r)-(26.5116+.2019*(1-i)+ -2.3741*Math.log(s)+0*Math.log(s)*Math.log(s)+0*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -2.4643*Math.log(o)+ -0.3914*u+ -0.0229*Math.log(a/f)+ -0.3087*l+ -0.2627*l*(1-i)+ -0.2355*c+0*c*i))/(Math.exp(-0.4312)*Math.exp(0*(26.5116+.2019*(1-i)+ -2.3741*Math.log(s)+0*Math.log(s)*Math.log(s)+0*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -2.4643*Math.log(o)+ -0.3914*u+ -0.0229*Math.log(a/f)+ -0.3087*l+ -0.2627*l*(1-i)+ -0.2355*c+0*c*i))))));b=t*(1-Math.exp(-Math.exp((Math.log(r)-(26.5116+.2019*(1-i)+ -2.3741*Math.log(s)+0*Math.log(s)*Math.log(s)+0*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -2.4643*Math.log(h)+ -0.3914*p+ -0.0229*Math.log(d/v)+ -0.3087*m+ -0.2627*m*(1-i)+ -0.2355*g+0*g*i))/(Math.exp(-0.4312)*Math.exp(0*(26.5116+.2019*(1-i)+ -2.3741*Math.log(s)+0*Math.log(s)*Math.log(s)+0*Math.log(s)*(1-i)+0*Math.log(s)*Math.log(s)*(1-i)+ -2.4643*Math.log(h)+ -0.3914*p+ -0.0229*Math.log(d/v)+ -0.3087*m+ -0.2627*m*(1-i)+ -0.2355*g+0*g*i))))))}var w=y-b,E=y*n/100,S=Math.max(0,w-E),x=100-(b+E+S).toFixed(1);$("#score_good").text(x.toFixed(1)+"%");$("#score_bad").text(b.toFixed(1)+"%");$("#score_bad_add").text(S.toFixed(1)+"%");$("#score_benefits").text(E.toFixed(1)+"%");var T=Math.round(b),N=Math.round(E),C=Math.round(S+E)-N,k=100-(T+C+N),L=$("#faces").empty();for(var A=0;A<T;A++)L.prepend(newFace("bad"));for(var A=0;A<C;A++)L.prepend(newFace("badA"));for(var A=0;A<N;A++)L.prepend(newFace("badP"));for(var A=0;A<k;A++)L.prepend(newFace("good"))}function newFace(e){var t=!1;"devicePixelRatio"in window&&(t=window.devicePixelRatio>1);var n=new Image;n.src="imgs/"+e+(t?"@2x":"")+".png";return n}function toggleCholesterolUnit(){_useMMOL=!_useMMOL;if(_useMMOL){$("#input").find(".chol_toggle").text("mmol/L");$("#input").find(".chol_mmol").show();$("#input").find(".chol_mgdl").hide()}else{$("#input").find(".chol_toggle").text("mg/dL");$("#input").find(".chol_mmol").hide();$("#input").find(".chol_mgdl").show()}adjust("chol",$("#totalchol"),!0);adjust("hdl",$("#hdlchol"),!0)}function showImages(e){var t="";"cvd"==e?t='<div><img src="imgs/heart_attack.jpg" />Heart Attacks</div><div><img src="imgs/heart_failure.jpg" />Heart Failure</div><div><img src="imgs/stroke.jpg" />Strokes</div><div><img src="imgs/intermittent.jpg" />Intermittent claudication</div>':"chd"==e?t='<div><img src="imgs/heart_attack.jpg" />Heart Attacks</div><div><img src="imgs/angina.jpg" />Angina</div>':"mi"==e?t='<div><img src="imgs/heart_attack.jpg" />Heart Attacks</div>':"stroke"==e&&(t='<div><img src="imgs/stroke.jpg" />Strokes</div>');$("#disease").html(t)}$(document).ready(function(){setFormulaById("cvd")});var _useMMOL=!0;Array.prototype.contains=function(e){return this.indexOf(e)>=0};"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1});